#include QMK_KEYBOARD_H


enum layers {
    _BASE,
    _SYML,
    _SYMR,
    _NAV,
    _NUM,
    _SYSTEM
};

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
	[_BASE] = LAYOUT(
    //,----------------------+-----------------------+-----------------------+-----------------------+-----------.                                          ,-----------------------+-----------------------+-----------------------+-----------------------+-------------------------.
        KC_Q,                   KC_W,                   KC_F,                   KC_P,                   KC_B,                                                  KC_J,                   KC_L,                   KC_U,                   KC_Y,                   KC_SCLN,
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
        MT(MOD_LGUI, KC_A),     MT(MOD_LALT, KC_R),     MT(MOD_LCTL, KC_S),     MT(MOD_LSFT, KC_T),     KC_G,                                                  KC_M,                   MT(MOD_RSFT, KC_N),     MT(MOD_RCTL, KC_E),     MT(MOD_LALT, KC_I),     MT(MOD_RGUI, KC_O),
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
        MT(MOD_RALT, KC_Z),     KC_X,                   KC_C,                   KC_D,                   KC_V,                                                  KC_K,                   KC_H,                   KC_COMMA,               KC_DOT,                 MT(MOD_RALT, KC_SLASH),
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
                                                                                                        OSL(2),     LT(3,KC_SPACE),         LT(3,KC_SPACE),    OSL(1)
                                                                                                   //`-----------+-----------------´      `-----------------+---------´
    ),
	[_SYML] = LAYOUT(
    //,----------------------+-----------------------+-----------------------+-----------------------+-----------.                                          ,-----------------------+-----------------------+-----------------------+-----------------------+-------------------------.
        KC_PERC,                KC_AT,                  KC_LCBR,                KC_RCBR,                KC_AMPR,                                               KC_NO,                  KC_NO,                  KC_NO,                  KC_NO,                  KC_NO,
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
        KC_HASH,                KC_DLR,                 KC_LPRN,                KC_RPRN,                KC_PIPE,                                               KC_NO,                  KC_RIGHT_SHIFT,         KC_RIGHT_CTRL,          KC_LEFT_ALT,            KC_RIGHT_GUI,
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
        KC_BSLS,                KC_LABK,                KC_LBRC,                KC_RBRC,                KC_RABK,                                               KC_NO,                  KC_NO,                  KC_NO,                  KC_NO,                  KC_RIGHT_ALT,
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
                                                                                                        TO(0),     KC_NO,                   KC_NO,             TO(4)
                                                                                                   //`-----------+-----------------´      `-----------------+---------´
    ),
	[_SYMR] = LAYOUT(
    //,----------------------+-----------------------+-----------------------+-----------------------+-----------.                                          ,-----------------------+-----------------------+-----------------------+-----------------------+-------------------------.
        KC_NO,                  KC_NO,                  KC_NO,                  KC_NO,                  KC_NO,                                                 KC_QUES,                KC_QUOTE,               KC_UNDS,                KC_EXLM,                KC_NO,
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
        KC_LEFT_GUI,            KC_LEFT_ALT,            KC_LEFT_CTRL,           KC_LEFT_SHIFT,          KC_NO,                                                 KC_CIRC,                KC_DQUO,                KC_MINUS,               KC_EQUAL,               KC_PLUS,
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
        KC_RIGHT_ALT,           LCTL(KC_X),             LCTL(KC_C),             LCTL(KC_V),             KC_NO,                                                 KC_NO,                  KC_GRAVE,               KC_SLASH,               KC_ASTR,                KC_TILD,
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
                                                                                                        TO(0),     KC_NO,                   KC_NO,             KC_NO
                                                                                                   //`-----------+-----------------´      `-----------------+---------´
    ),
	[_NAV] = LAYOUT(
    //,----------------------+-----------------------+-----------------------+-----------------------+-----------.                                          ,-----------------------+-----------------------+-----------------------+-----------------------+-------------------------.
        KC_6,                   KC_7,                   KC_8,                   KC_9,                   KC_0,                                                  KC_1,                   KC_2,                   KC_3,                   KC_4,                   KC_5,
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
        KC_LEFT_GUI,            MT(MOD_LALT, KC_ESCAPE),MT(MOD_LCTL, KC_TAB),   MT(MOD_LSFT, KC_ENTER), KC_APPLICATION,                                        KC_LEFT,                MT(MOD_RSFT, KC_DOWN),  MT(MOD_RCTL, KC_UP),    MT(MOD_LALT, KC_RIGHT), MT(MOD_RGUI, KC_ENTER),
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
        KC_RIGHT_ALT,           KC_NO,                  CW_TOGG,                KC_CAPS,                KC_NO,                                                 KC_HOME,                KC_PGDN,                KC_PAGE_UP,             KC_END,                 MT(MOD_RALT, KC_TAB),
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
                                                                                                        TO(0),     TT(4),                   OSL(4),             MO(5)
                                                                                                   //`-----------+-----------------´      `-----------------+---------´
    ),
	[_NUM] = LAYOUT(
    //,----------------------+-----------------------+-----------------------+-----------------------+-----------.                                          ,-----------------------+-----------------------+-----------------------+-----------------------+-------------------------.
        KC_NO,                  KC_F7,                  KC_F8,                  KC_F9,                  KC_F12,                                                KC_EQUAL,               KC_7,                   KC_8,                   KC_9,                   KC_NO,
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
        KC_LEFT_GUI,            MT(MOD_LALT, KC_F4),    MT(MOD_LCTL, KC_F5),    MT(MOD_LSFT, KC_F6),    KC_F11,                                                KC_NO,                  KC_4,                   KC_5,                   KC_6,                   KC_RIGHT_GUI,
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
        KC_RIGHT_ALT,           KC_F1,                  KC_F2,                  KC_F3,                  KC_F10,                                                KC_0,                   KC_1,                   KC_2,                   KC_3,                   MT(MOD_RALT, KC_SLASH),
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
                                                                                                        TO(0),     TO(0),                   TO(0),             TO(0)
                                                                                                   //`-----------+-----------------´      `-----------------+---------´
    ),
	[_SYSTEM] = LAYOUT(
    //,----------------------+-----------------------+-----------------------+-----------------------+-----------.                                          ,-----------------------+-----------------------+-----------------------+-----------------------+-------------------------.
        KC_NO,                  KC_NO,                  KC_NO,                  KC_NO,                  KC_NO,                                                 KC_NO,                  KC_PAUSE,               KC_PSCR,                KC_SYSTEM_SLEEP,        KC_SYSTEM_POWER,
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
        KC_AUDIO_VOL_DOWN,      KC_AUDIO_VOL_UP,        KC_MEDIA_PREV_TRACK,    KC_MEDIA_PLAY_PAUSE,    KC_MEDIA_NEXT_TRACK,                                   KC_NO,                  KC_RIGHT_SHIFT,         KC_RIGHT_CTRL,          KC_LEFT_ALT,            KC_RIGHT_GUI,
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
        KC_AUDIO_MUTE,          KC_NO,                  KC_NO,                  KC_MEDIA_STOP,          KC_NO,                                                 KC_NO,                  KC_NO,                  KC_NO,                  KC_NO,                  KC_NO,
    //|----------------------+-----------------------+-----------------------+-----------------------+-----------|                                          |-----------------------+-----------------------+-----------------------+-----------------------+-------------------------|
                                                                                                        TO(0),     KC_NO,                   KC_NO,             KC_NO
                                                                                                   //`-----------+-----------------´      `-----------------+---------´
    ),
};




const uint16_t PROGMEM combo_lu[] = { KC_L, KC_U, COMBO_END};
const uint16_t PROGMEM combo_yscln[] = { KC_Y, KC_SCLN, COMBO_END};
const uint16_t PROGMEM combo_xc[] = { KC_X, KC_C, COMBO_END};
const uint16_t PROGMEM combo_cd[] = { KC_C, KC_D, COMBO_END};
const uint16_t PROGMEM combo_hcomma[] = { KC_H, KC_COMMA, COMBO_END};
const uint16_t PROGMEM combo_commadot[] = { KC_COMMA, KC_DOT, COMBO_END};
const uint16_t PROGMEM combo_fp[] = { KC_F, KC_P, COMBO_END};
const uint16_t PROGMEM combo_uy[] = { KC_U, KC_Y, COMBO_END};
const uint16_t PROGMEM combo_89[] = { KC_8, KC_9, COMBO_END};

combo_t key_combos[] = {
    COMBO(combo_lu, LCTL(KC_BSPC)),
    COMBO(combo_yscln, KC_DELETE),
    COMBO(combo_xc, KC_TAB),
    COMBO(combo_cd, KC_ENTER),
    COMBO(combo_hcomma, KC_QUOTE),
    COMBO(combo_commadot, KC_MINUS),
    COMBO(combo_fp, KC_ESCAPE),
    COMBO(combo_uy, KC_BSPC),
    COMBO(combo_89, KC_BSPC),
};

// disable liatris power led
void keyboard_pre_init_user(void) {
  // Set our LED pin as output
  setPinOutput(24);
  // Turn the LED off
  // (Due to technical reasons, high is off and low is on)
  writePinHigh(24);
}

bool rgb_matrix_indicators_user(void) {
    // keys left 0-16, back 17-22, keys right 23-39, back 40-45
    switch(get_highest_layer(layer_state|default_layer_state)) {
        case 4:
            rgb_matrix_set_color(39, RGB_YELLOW);
            break;
        case 2:
            rgb_matrix_set_color(15, RGB_BLUE);
            break;
        case 1:
            rgb_matrix_set_color(39, RGB_BLUE);
            break;
        case 0:
            rgb_matrix_set_color_all(0, 0, 0);
            break;
        default:
            break;
    }
    return false;
}
